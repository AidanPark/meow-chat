# 간단한 Unit 정규화 접근법의 한계 분석

## 구현된 접근법
접두어 제거 위주의 간단한 unit 정규화:
1. µ, μ, u -> µ로 통일
2. l, L, ℓ -> L로 통일  
3. 공백 제거
4. 특정 접두어만 변환: 10^3, 10³, x10^3, X10^3, k, K -> K로 통일

## 주요 한계 분석

### 1. 단위 사전 부재로 인한 검증 불가
**문제점:**
- 잘못된 단위 입력에 대한 검증 불가
- 오타나 비표준 표기 감지 불가
- 의료 장비별 단위 표기 차이 처리 불가

**예시:**
```python
# 문제 사례들
normalize_unit_simple("kg/dL")    # -> "kg/dL" (잘못된 단위지만 통과)
normalize_unit_simple("mg/dl")    # -> "mg/dl" (소문자 L 미처리)
normalize_unit_simple("mEq/L")    # -> "mEq/L" (정상이지만 검증 불가)
normalize_unit_simple("xyz/abc")  # -> "xyz/abc" (완전히 잘못된 단위도 통과)
```

### 2. 제한적인 접두어 처리
**문제점:**
- 하드코딩된 패턴만 처리 가능
- 새로운 변형 패턴 대응 불가
- 복잡한 지수 표기 처리 불가

**예시:**
```python
# 처리되지 않는 케이스들
normalize_unit_simple("10^9/L")     # -> "10^9/L" (10^9 -> G 변환 안됨)
normalize_unit_simple("1000/µL")    # -> "1000/µL" (1000 -> K 변환 안됨)
normalize_unit_simple("×10³/µL")    # -> "×10³/µL" (× 기호 처리 안됨)
normalize_unit_simple("E3/µL")      # -> "E3/µL" (E notation 처리 안됨)
```

### 3. OCR 오류에 대한 견고성 부족
**문제점:**
- 특수문자 인식 오류 처리 불가
- 숫자/문자 혼동 처리 불가
- 공백/구분자 오류 처리 불가

**예시:**
```python
# OCR 오류 사례들
normalize_unit_simple("l0^3/µL")    # -> "l0^3/µL" (1을 l로 인식한 경우)
normalize_unit_simple("10A3/µL")    # -> "10A3/µL" (^를 A로 인식한 경우)
normalize_unit_simple("K/ µL")      # -> "K/µL" (공백은 제거되지만 패턴 매칭 실패)
```

### 4. 문맥 정보 부족
**문제점:**
- 검사 항목 코드와 단위 매칭 불가
- 의료 장비별 표기법 차이 처리 불가
- 단위 호환성 검증 불가

**예시:**
```python
# 문맥 무시 사례들
# WBC는 K/µL이어야 하는데 다른 단위가 와도 검증 불가
{"code": "WBC", "unit": "mg/dL"}  # 논리적으로 틀렸지만 통과
{"code": "GLU", "unit": "K/µL"}   # 논리적으로 틀렸지만 통과
```

### 5. 복합 단위 처리 불가
**문제점:**
- 비율 단위 처리 불가
- 복합 지수 처리 불가
- 특수 의료 단위 처리 불가

**예시:**
```python
# 복합 단위 사례들
normalize_unit_simple("mg/dL/hr")        # 시간당 변화율
normalize_unit_simple("µmol/L/mmol")     # 복합 농도
normalize_unit_simple("cells/mm³")       # 부피당 세포수
normalize_unit_simple("copies/mL")       # 분자 진단 단위
```

### 6. 정밀도와 안전성 트레이드오프
**문제점:**
- 너무 관대한 정규화로 잘못된 데이터 허용
- 보수적 접근으로 놓치는 정당한 변형들
- 에러 처리 부족

### 7. 확장성 부족
**문제점:**
- 새로운 단위 추가 시 코드 수정 필요
- 장비별/지역별 표기법 차이 대응 어려움
- 표준 변화 대응 어려움

## 개선 방향

### 단기 개선안:
1. **패턴 확장**: 더 많은 접두어 변형 패턴 추가
2. **기본 검증**: 허용 가능한 단위 화이트리스트 추가
3. **에러 로깅**: 정규화 실패 케이스 로깅

### 장기 개선안:
1. **하이브리드 접근**: 간단한 정규화 + 선택적 사전 검증
2. **기계학습**: OCR 오류 패턴 학습을 통한 자동 교정
3. **문맥 활용**: 검사 코드 기반 단위 검증 추가

## 결론
간단한 접두어 제거 접근법은:
- ✅ **장점**: 빠르고 가볍며 핵심 케이스(10^3/µL -> K/µL) 처리 가능
- ❌ **단점**: 검증 부족, 견고성 부족, 확장성 제한
- 🎯 **적용**: 제한된 환경에서 빠른 프로토타이핑용으로 적합하나, 프로덕션에서는 보완 필요